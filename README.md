# ryegen

[![Go Reference](https://pkg.go.dev/badge/github.com/refaktor/ryegen.svg)](https://pkg.go.dev/github.com/refaktor/ryegen)

Package ryegen allows the use of Go libraries in the Rye programming language (https://ryelang.org/).

It is an automatic binding generation utility that allows the creation of custom Rye interpreters, which include the functionality of specific Go libraries.

## Getting started

Create a new Go project
```bash
mkdir my_ryegen_project
cd my_ryegen_project
go mod init my_ryegen_project
go get -u github.com/refaktor/ryegen@main
go get -u github.com/refaktor/rye@main
```

Set up ryegen using ryegen-init (replace "fyne.io/fyne/v2" with any Go library)
```bash
go run github.com/refaktor/ryegen/cmd/ryegen-init@main fyne.io/fyne/v2
```

Run the generator
```bash
go mod tidy
go generate ./...
```

Edit the "config.toml" file to your liking. See https://github.com/refaktor/rye-fyne/blob/main/generate/config.toml and https://github.com/refaktor/rye-ebitengine/blob/main/generate/config.toml for examples.

Optional: Edit "bindings.txt" to exclude specific functions from your bindings.

Re-run `go generate ./...` after making any configuration changes.

Build the Rye interpreter with bindings
```bash
go build
```

## Adding another binding / managing bindings with build tags

Rename your `ryegen` directory (originally generated by ryegen-init)
```bash
mv ryegen ryegen_fyne
```

Re-run ryegen-init with new Go library (use the -name flag to specify a directory name)
```bash
go run github.com/refaktor/ryegen/cmd/ryegen-init@main github.com/hajimehoshi/ebiten -name="ryegen_ebitengine"
```

In both generator directories (e.g. `ryegen_fyne` and `ryegen_ebitengine`), edit the `config.toml` and by uncommenting and changing the `build-flag` property

`ryegen_fyne/config.toml:`
```toml
#...
build-flag = "b_fyne"
#...
```

`ryegen_ebitengine/config.toml:`
```toml
#...
build-flag = "b_ebitengine"
#...
```

Compile the Rye interpreter with bindings
```bash
# Bind both libraries
go build -tags "b_fyne b_ebitengine"
# Bind only fyne
go build -tags "b_fyne"
```
